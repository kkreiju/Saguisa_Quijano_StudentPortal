@{
	ViewData["Title"] = "Schedule Entry";
}

@model StudentPortal.Models.SchedulesViewModel

<h1>Schedule Entry</h1>

<!-- 
		remove category in the database if i proceed to implement to get subject db

		however, idk yet how to retrieve the other model
-->

@if (ViewBag.Message != null && ViewBag.Message.Contains("registered"))
{
	<div class="alert alert-danger mt-3">
		<p class="my-0">@ViewBag.Message</p>
	</div>
}
else if (ViewBag.Message == "Schedule added.")
{
	<div class="alert alert-success mt-3">
		<p class="my-0">@ViewBag.Message</p>
	</div>
}

<form method="post" id="form">
	<div class="mt-3">
		<label class="form-label">EDP Code</label>
		<input type="number" class="form-control shadow-lg" name="edpcode" asp-for="EDPCode" required />
	</div>

	<div class="mt-3">
		<label class="form-label">Subject Code</label>
		<input type="text" style="text-transform: uppercase;" class="form-control shadow-lg" name="subjectcode" asp-for="SubjCode" maxlength="15" required />
	</div>

	<div class="row">
		<div class="col mt-3">
			<label class="form-label">Time Start</label>
			<input type="time" class="form-control shadow-lg" name="starttime" asp-for="StartTime" required />
		</div>

		<div class="col mt-3">
			<label class="form-label">Time End</label>
			<input type="time" class="form-control shadow-lg" name="endtime" asp-for="EndTime" required />
		</div>
	</div>

	<div class="mt-3">
		<legend>Days</legend>
		<div>
			<input class="form-check-input" type="checkbox" value="MON" id="monday" />
			<label class="form-check-label" for="monday">Monday</label>
		</div>
		<div>
			<input class="form-check-input" type="checkbox" value="TUE" id="tuesday" />
			<label class="form-check-label" for="tuesday">Tuesday</label>
		</div>
		<div>
			<input class="form-check-input" type="checkbox" value="WED" id="wednesday" />
			<label class="form-check-label" for="wednesday">Wednesday</label>
		</div>
		<div>
			<input class="form-check-input" type="checkbox" value="THU" id="thursday" />
			<label class="form-check-label" for="thursday">Thursday</label>
		</div>
		<div>
			<input class="form-check-input" type="checkbox" value="FRI" id="friday" />
			<label class="form-check-label" for="friday">Friday</label>
		</div>
		<div>
			<input class="form-check-input" type="checkbox" value="SAT" id="saturday" />
			<label class="form-check-label" for="saturday">Saturday</label>
		</div>
	</div>

	<!-- Hidden field to store concatenated values -->
	<input type="hidden" asp-for="Days" id="days" />

	<div class="col mt-3">
		<label class="form-label">Category</label>
		<select id="category" class="form-select shadow-lg" name="category" asp-for="Category">
			<option value="LEC">Lecture</option>
			<option value="LAB">Laboratory</option>
		</select>
	</div>

	<div class="mt-3">
		<label class="form-label">Room</label>
		<input type="text" style="text-transform: uppercase;" class="form-control shadow-lg" name="room" asp-for="Room" maxlength="5" required />
	</div>

	<div class="mt-3">
		<label class="form-label">Max Size</label>
		<input type="number" class="form-control shadow-lg" name="maxsize" asp-for="MaxSize" required />
	</div>

	<div class="mt-3">
		<label class="form-label">Section</label>
		<input type="text" style="text-transform: uppercase;" class="form-control shadow-lg" name="section" asp-for="Section" maxlength="3" required />
	</div>

	<div class="mt-3">
		<label class="form-label">School Year</label>
		<input type="text" style="text-transform: uppercase;" class="form-control shadow-lg" name="schoolyear" asp-for="SchoolYear" maxlength="10" required />
	</div>

	<div class="mt-3">
		<button type="submit" class="btn btn-primary">Save</button>
		<button type="button" class="btn btn-danger" onclick="clearForm()">Cancel</button>
	</div>
</form>

<script>
	function clearForm() {
		document.getElementById("form").reset();
	}

	function updateSelectedDays() {
		const checkboxes = document.querySelectorAll('.form-check-input');
		const selectedDays = Array.from(checkboxes)
			.filter(checkbox => checkbox.checked)
			.map(checkbox => checkbox.value)
			.join(',');

		// Store the result in the hidden field
		document.getElementById('days').value = selectedDays;
	}

	// Add event listener to all checkboxes
	document.querySelectorAll('.form-check-input').forEach(checkbox => {
		checkbox.addEventListener('change', updateSelectedDays);
	});
</script>
